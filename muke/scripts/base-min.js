$(document).ready(function(){loginBtn();signinBtn();logoutBtn();login();register();setUserName();getCourseInfo()});function loginBtn(){$("#login #main").click(function(a){window.event?window.event.cancelBubble=true:a.stopPropagation()});$(".loginBtn").click(function(){$("#login").fadeIn()});$("#login").click(function(){$("#login").fadeOut()})}function signinBtn(){$("#signin #main").click(function(a){window.event?window.event.cancelBubble=true:a.stopPropagation()});$(".signinBtn").click(function(){$("#signin").fadeIn()});$("#signin").click(function(){$("#signin").fadeOut()})}function logoutBtn(){$(".logoutBtn").click(function(){sessionStorage.setItem("username","null");$(".username").text("");$(".loginBtn").show();$(".signinBtn").show();$(".logoutBtn").hide()})}function login(){$("#loginBtn").click(function(){var a=$("#uname").val();var b=$("#upwd").val();$.post("login.action",{uname:a,upwd:b},function(d,c){if(d==""){alert("登录失败！")}else{sessionStorage.setItem("username",d);setUserName();$("#login").hide()}})})}function register(){$("#register").click(function(){var a=$("#rtel").val();var b=$("#rname").val();var c=$("#rpwd").val();$.post("register.action",{rtel:a,rname:b,rpwd:c},function(e,d){if(e=="true"){alert("注册成功！");location.reload()}else{alert("该账户已被占用！")}})})}function setUserName(){var a=sessionStorage.getItem("username");if(a!=""&&a!="null"&&a!=null){$(".username").text(a);$(".loginBtn").hide();$(".signinBtn").hide();$(".logoutBtn").show()}else{$(".username").text("");$(".loginBtn").show();$(".signinBtn").show();$(".logoutBtn").hide()}}function getCourseInfo(){$(".dir li").click(function(){var c=$(".first .current").find("a").text();var b=$(".second .current").find("a").text();var a=$(".third .current").find("a").text();$.post("queryCourse.action",{course_direction:c,course_classification:b,course_rank:a},function(d){var e="";$.each(JSON.parse(d),function(f,g){e+="<li><div>"+g.course_studyTime+" | "+g.course_rank+"</div><a href='javascript:void(0);'><img src='imgs/courses/"+g.course_id+".jpg' /><h3>"+g.course_name+"</h3><p>"+g.course_description+"</p><span>"+g.course_progress+"</span>&nbsp;&nbsp;&nbsp;&nbsp;<span>"+g.course_studyNum+"人在学习</span></a></li>"});$(".courses ul").html(e)})})};